<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Test page</title>
  <style>
      td:last-child {
        background-color: #c8d86d;
        max-width:300px;
        word-wrap:break-word;
      }
      td.failed {
        background-color: #f45159;
      }
      table, th, td {
        border: 1px solid black;
      }
      span.age {
        float: right;
        margin-left: 40px;
        margin-right: 10px;
      }
    </style>
  
 </head>
 <body>
  <h1>Hello world!</h1>
  <div class="block1">Block #1</div>
  <div class="redirect">
   <a target="_blank" id="redirect" href="https://decoyduck.github.io/redirect_1.html">Test redirect</a>
  </div>
    <div class="bot-detect">
   <a target="_blank" id="bot-detect" href="https://intoli.com/blog/not-possible-to-block-chrome-headless/chrome-headless-test.html">Bot detect</a>
  </div>
    <div class="user-agent">
   <a target="_blank" id="user-agent" href="https://www.whatismybrowser.com/detect/what-is-my-user-agent">what-is-my-user-agentt</a>
  </div>
    <div class="self-link">
   <a target="_blank" id="self-link" href="https://decoyduck.github.io/index.html">what-is-my-user-agentt</a>
  </div>

  <table>
      <tr>
        <th>Test Name</th>
        <th>Result</th>
      </tr>
      <tr>
        <td>User Agent <span class="age">(Old)</span></td>
        <td class="failed result" id="user-agent-result"></td>
      </tr>
      <tr>
        <td>WebDriver <span class="age">(New)</span></td>
        <td class="failed result" id="webdriver-result">present (failed)</td>
      </tr>
      <tr>
        <td>Chrome <span class="age">(New)</span></td>
        <td class="failed result" id="chrome-result">missing (failed)</td>
      </tr>
      <tr>
        <td>Permissions <span class="age">(New)</span></td>
        <td class="failed result" id="permissions-result"></td>
      </tr>
      <tr>
        <td>Plugins Length <span class="age">(Old)</span></td>
        <td class="failed result" id="plugins-length-result"></td>
      </tr>
      <tr>
        <td>Languages <span class="age">(Old)</span></td>
        <td class="failed result" id="languages-result"></td>
      </tr>
         <tr>
        <td>User agent <span class="ua">(Old)</span></td>
        <td class="failed result" id="ua-result"></td>
      </tr>

    </table>
  <script>
   console.log('Page script run');
   // User-Agent Test
const userAgentElement = document.getElementById('user-agent-result');
userAgentElement.innerHTML = navigator.userAgent;
if (/HeadlessChrome/.test(navigator.userAgent)) {
  userAgentElement.classList.add('failed');
  userAgentElement.classList.remove('passed');
} else {
  userAgentElement.classList.add('passed');
  userAgentElement.classList.remove('failed');
}

// Webdriver Test
const webdriverElement = document.getElementById('webdriver-result');
if (navigator.webdriver) {
  webdriverElement.classList.add('failed');
  webdriverElement.classList.remove('passed');
  webdriverElement.innerHTML = 'present (failed)';
} else {
  webdriverElement.classList.add('passed');
  webdriverElement.classList.remove('failed');
  webdriverElement.innerHTML = 'missing (passed)';
}

// Chrome Test
const chromeElement = document.getElementById('chrome-result');
if (!window.chrome) {
  chromeElement.classList.add('failed');
  chromeElement.classList.remove('passed');
  chromeElement.innerHTML = 'missing (failed)';
} else {
  chromeElement.classList.add('passed');
  chromeElement.classList.remove('failed');
  chromeElement.innerHTML = 'present (passed)';
}

// Permissions Test
const permissionsElement = document.getElementById('permissions-result');
(async () => {
  const permissionStatus = await navigator.permissions.query({ name: 'notifications' });
  permissionsElement.innerHTML = permissionStatus.state;
  if(Notification.permission === 'denied' && permissionStatus.state === 'prompt') {
    permissionsElement.classList.add('failed');
    permissionsElement.classList.remove('passed');
  } else {
    permissionsElement.classList.add('passed');
    permissionsElement.classList.remove('failed');
  }
})();

// Plugins Length Test
const pluginsLengthElement = document.getElementById('plugins-length-result');
pluginsLengthElement.innerHTML = navigator.plugins.length;
if (navigator.plugins.length === 0) {
  pluginsLengthElement.classList.add('failed');
  pluginsLengthElement.classList.remove('passed');
} else {
  pluginsLengthElement.classList.add('passed');
  pluginsLengthElement.classList.remove('failed');
}

// Languages Test
const languagesElement = document.getElementById('languages-result');
languagesElement.innerHTML = navigator.languages;
if (!navigator.languages || navigator.languages.length === 0) {
  languagesElement.classList.add('failed');
  languagesElement.classList.remove('passed');
} else {
  languagesElement.classList.add('passed');
  languagesElement.classList.remove('failed');
}
   // Languages Test
const uaElement = document.getElementById('ua-result');
uaElement.innerHTML = navigator.userAgent;

  </script>
 </body>
</html>
